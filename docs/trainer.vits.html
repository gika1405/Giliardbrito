---

title: Debugging


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/trainer.vits.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/trainer.vits.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Table of Contents<span class="tocSkip"></span></h1></p>
<div class="toc"><ul class="toc-item"><li><span><a href="#Debugging" data-toc-modified-id="Debugging-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Debugging</a></span></li><li><span><a href="#Trainer" data-toc-modified-id="Trainer-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Trainer</a></span></li><li><span><a href="#Losses" data-toc-modified-id="Losses-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Losses</a></span></li><li><span><a href="#VITS-Trainer" data-toc-modified-id="VITS-Trainer-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>VITS Trainer</a></span></li></ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Table of Contents<span class="tocSkip"></span></h1></p>
<div class="toc"><ul class="toc-item"></ul></div>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">librosa</span>
<span class="kn">import</span> <span class="nn">librosa.util</span> <span class="k">as</span> <span class="nn">librosa_util</span>
<span class="kn">from</span> <span class="nn">librosa.util</span> <span class="kn">import</span> <span class="n">normalize</span><span class="p">,</span> <span class="n">pad_center</span><span class="p">,</span> <span class="n">tiny</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">get_window</span>
<span class="kn">from</span> <span class="nn">scipy.io.wavfile</span> <span class="kn">import</span> <span class="n">read</span>
<span class="kn">from</span> <span class="nn">librosa.filters</span> <span class="kn">import</span> <span class="n">mel</span> <span class="k">as</span> <span class="n">librosa_mel_fn</span>

<span class="n">MAX_WAV_VALUE</span> <span class="o">=</span> <span class="mf">32768.0</span>

<span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">dynamic_range_compression_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clip_val</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PARAMS</span>
<span class="sd">    ------</span>
<span class="sd">    C: compression factor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">clip_val</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">dynamic_range_decompression_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PARAMS</span>
<span class="sd">    ------</span>
<span class="sd">    C: compression factor used to compress</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">C</span>


<span class="k">def</span> <span class="nf">spectral_normalize_torch</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">dynamic_range_compression_torch</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">spectral_de_normalize_torch</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">dynamic_range_decompression_torch</span><span class="p">(</span><span class="n">magnitudes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>


<span class="n">mel_basis</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">hann_window</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">def</span> <span class="nf">spectrogram_torch</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">hop_size</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;min value is &quot;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max value is &quot;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

    <span class="k">global</span> <span class="n">hann_window</span>
    <span class="n">dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="n">wnsize_dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">win_size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dtype_device</span>
    <span class="k">if</span> <span class="n">wnsize_dtype_device</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hann_window</span><span class="p">:</span>
        <span class="n">hann_window</span><span class="p">[</span><span class="n">wnsize_dtype_device</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hann_window</span><span class="p">(</span><span class="n">win_size</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
        <span class="n">y</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">-</span> <span class="n">hop_size</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">-</span> <span class="n">hop_size</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_size</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">win_size</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">hann_window</span><span class="p">[</span><span class="n">wnsize_dtype_device</span><span class="p">],</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
        <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">onesided</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spec</span>


<span class="k">def</span> <span class="nf">spec_to_mel_torch</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">num_mels</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">mel_basis</span>
    <span class="n">dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="n">fmax_dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmax</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dtype_device</span>
    <span class="k">if</span> <span class="n">fmax_dtype_device</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mel_basis</span><span class="p">:</span>
        <span class="n">mel</span> <span class="o">=</span> <span class="n">librosa_mel_fn</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">num_mels</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
        <span class="n">mel_basis</span><span class="p">[</span><span class="n">fmax_dtype_device</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">mel</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">spec</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">spec</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mel_basis</span><span class="p">[</span><span class="n">fmax_dtype_device</span><span class="p">],</span> <span class="n">spec</span><span class="p">)</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">spectral_normalize_torch</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spec</span>


<span class="k">def</span> <span class="nf">mel_spectrogram_torch</span><span class="p">(</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">num_mels</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">hop_size</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;min value is &quot;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max value is &quot;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

    <span class="k">global</span> <span class="n">mel_basis</span><span class="p">,</span> <span class="n">hann_window</span>
    <span class="n">dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="n">fmax_dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmax</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dtype_device</span>
    <span class="n">wnsize_dtype_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">win_size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dtype_device</span>
    <span class="k">if</span> <span class="n">fmax_dtype_device</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mel_basis</span><span class="p">:</span>
        <span class="n">mel</span> <span class="o">=</span> <span class="n">librosa_mel_fn</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">num_mels</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
        <span class="n">mel_basis</span><span class="p">[</span><span class="n">fmax_dtype_device</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">mel</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">wnsize_dtype_device</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hann_window</span><span class="p">:</span>
        <span class="n">hann_window</span><span class="p">[</span><span class="n">wnsize_dtype_device</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hann_window</span><span class="p">(</span><span class="n">win_size</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
        <span class="n">y</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">-</span> <span class="n">hop_size</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_fft</span> <span class="o">-</span> <span class="n">hop_size</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_size</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">win_size</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">hann_window</span><span class="p">[</span><span class="n">wnsize_dtype_device</span><span class="p">],</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
        <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">onesided</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mel_basis</span><span class="p">[</span><span class="n">fmax_dtype_device</span><span class="p">],</span> <span class="n">spec</span><span class="p">)</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">spectral_normalize_torch</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spec</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Trainer">Trainer<a class="anchor-link" href="#Trainer"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Losses">Losses<a class="anchor-link" href="#Losses"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="feature_loss" class="doc_header"><code>feature_loss</code><a href="https://github.com/uberduck-ai/uberduck_ml_dev/tree/master/uberduck_ml_dev/trainer/vits.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>feature_loss</code>(<strong><code>fmap_r</code></strong>, <strong><code>fmap_g</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="discriminator_loss" class="doc_header"><code>discriminator_loss</code><a href="https://github.com/uberduck-ai/uberduck_ml_dev/tree/master/uberduck_ml_dev/trainer/vits.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>discriminator_loss</code>(<strong><code>disc_real_outputs</code></strong>, <strong><code>disc_generated_outputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generator_loss" class="doc_header"><code>generator_loss</code><a href="https://github.com/uberduck-ai/uberduck_ml_dev/tree/master/uberduck_ml_dev/trainer/vits.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generator_loss</code>(<strong><code>disc_outputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="kl_loss" class="doc_header"><code>kl_loss</code><a href="https://github.com/uberduck-ai/uberduck_ml_dev/tree/master/uberduck_ml_dev/trainer/vits.py#L87" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>kl_loss</code>(<strong><code>z_p</code></strong>, <strong><code>logs_q</code></strong>, <strong><code>m_p</code></strong>, <strong><code>logs_p</code></strong>, <strong><code>z_mask</code></strong>)</p>
</blockquote>
<p>z_p, logs_q: [b, h, t_t]
m_p, logs_p: [b, h, t_t]</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="VITS-Trainer">VITS Trainer<a class="anchor-link" href="#VITS-Trainer"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VITSTrainer" class="doc_header"><code>class</code> <code>VITSTrainer</code><a href="https://github.com/uberduck-ai/uberduck_ml_dev/tree/master/uberduck_ml_dev/trainer/vits.py#L107" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VITSTrainer</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/uberduck_ml_dev/trainer.base.html#TTSTrainer"><code>TTSTrainer</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

